---
title: http学习
tags:
  - 搭建博客
  - 前端
date: 2021-11-04 22:13:42
abbrlink: 80o51
---
time_wait close_wait  https://www.cnblogs.com/cangqinglang/p/13185825.html
http  不做持久化处理  无状态（stateless）协议
请求行（请求方法 url 协议版本）
请求头 请求体

响应行（协议版本 状态码 状态描述）
响应头 响应体

HTTP/1.1 虽然是无状态协议，但为了实现期望的保持状态功能，于 是引入了 Cookie 技术

HTTP 协议使用 URI 定位互联网上的资源。正是因为 URI 的特定功 能，在互联网上任意位置的资源都能访问到

GET ：获取资源   304 Not Modified

POST：传输实体主体    

PUT：传输文件  不安全  REST（REpresentational State Transfer，表征状态转移）  204 No Content

HEAD：获得报文首部   HEAD 方法和 GET 方法一样，只是不返回报文主体部分。用于确认 URI 的有效性及资源更新的日期时间等

DELETE：删除文件

OPTIONS：询问支持的方法

TRACE：追踪路径  TRACE方法是让 Web 服务器端将之前的请求通信环回给客户端的方法。  (容易引发 XST（Cross-Site Tracing，跨站追踪）攻击 不常用)
客户端通过 TRACE 方法可以查询发送出去的请求是怎样被加工修改 / 篡改的。这是因为，请求想要连接到源目标服务器可能会通过代理 中转，TRACE 方法就是用来确认连接过程中发生的一系列操作

CONNECT：要求用隧道协议连接代理
与代理服务器通信时建立隧道，实现用隧道协 议进行 TCP 通信。主要使用 SSL（Secure Sockets Layer，安全套接 层）和 TLS（Transport Layer Security，传输层安全）协议把通信内容 加 密后经网络隧道传输


>使用浏览器浏览一个包含多张图片的 HTML页面时，在发送 请求访问 HTML页面资源的同时，也会请求该 HTML页面里包含的 其他资源。因此，每次的请求都会造成无谓的 TCP 连接建立和断 开，增加通信量的开销

在 HTTP/1.1 协议中存在一个问题：单个 TCP 连接在一个时刻只能处理一个请求
HTTP2 提供了 Multiplexing 多路传输特性，让我们可以在一个 TCP 连接中同时完成多个 HTTP 请求

假设我们还处在 HTTP/1.1 时代，那个时候没有多路传输。

当浏览器拿到一个有几十张图片的网页该怎么办呢？

肯定不能只开一个 TCP 连接顺序下载，那样用户肯定等的很难受。但是如果每个图片都开一个 TCP 连接发 HTTP 请求，那电脑或者服务器都可能受不了——要是有 1000 张图片的话总不能开 1000 个 TCP 连接吧。

所以浏览器允许我们对同一 host 开启多个 TCP 连接，每个浏览器的数量是不一样的。Chrome 最多允许对同一个 Host 建立六个 TCP 连接。

如果是「短连接」，那么一次 TCP 连接就只能对应一次 HTTP 请求；
如果是「长连接」，那么一次 TCP 连接就可以发送多个 HTTP 请求了

持久连接使得多数请求以管线化（pipelining）方式发送成为可能。从 前发送请求后需等待并收到响应，才能发送下一个请求。管线化技术 出现后，不用等待响应亦可直接发送下一个请求

>Cookie 技术通过在请求和响应报文中写入 Cookie 信 息来控制客户端的状态
Cookie 会根据从服务器端发送的响应报文内的一个叫做 Set-Cookie 的 首部字段信息，通知客户端保存 Cookie。当下次客户端再往该服务器 发送请求时，客户端会自动在请求报文中加入 Cookie 值后发送出 去。服务器端发现客户端发送过来的 Cookie 后，会去检查究竟是从哪一 个客户端发来的连接请求，然后对比服务器上的记录，最后得到之前 的状态信息

用于 HTTP 协议交互的信息被称为 HTTP 报文


请求首部字段   
通用首部字段
实体首部字段

响应首部字段
通用首部字段
实体首部字段

报文主体和实体主体的差异  ？？？

压缩传输的内容编码 gzip（GNU zip） compress（UNIX 系统的标准压缩） deflate（zlib） identity（不进行编码）

MIME（Multipurpose Internet Mail Extensions，多用途因特网邮件扩展）机制

状态码的职责是当客户端向服务器端发送请求时，描述返回的请求结果。


204 No Content  请求处理成功，但没有资源返回

206 Partial Content
该状态码表示客户端进行了范围请求，而服务器成功执行了这部分的 GET 请求。响应报文中包含由 Content-Range 指定范围的实体内容。

400 Bad Request
该状态码表示请求报文中存在语法错误。当错误发生时，需修改请求 的内容后再次发送请求。另外，浏览器会像 200 OK 一样对待该状态 码。

401 Unauthorized
该状态码表示发送的请求需要有通过 HTTP 认证（BASIC 认证、 DIGEST 认证）的认证信息。另外若之前已进行过 1 次请求，则表示 用 户认证失败。

403 Forbidden
请求资源的访问被服务器拒绝

404 Not Found
该状态码表明服务器上无法找到请求的资源。除此之外，也可以在服务器端拒绝请求且不想说明理由时使用

500 Internal Server Error
该状态码表明服务器端在执行请求时发生了错误。也有可能是 Web 应用存在的 bug 或某些临时的故障。

503 Service Unavailable
该状态码表明服务器暂时处于超负载或正在进行停机维护，现在无法处理请求。


请求报文首部字段  含有内容协商

使用首部字段是为了给浏览器和服务器提供报文主体大小、所使用的语言、认证信息等内容

首部字段名: 字段值
在 HTTP 首部中以 Content-Type 这个字段来表示报文主体的 对象类型

当 HTTP 报文首部中出现了两个或两个以上具有相同首部字段名时 会怎么样？这种情况在规范内尚未明确，根据浏览器内部处理逻辑 的不同，结果可能并不一致。有些浏览器会优先处理第一次出现的 首部字段，而有些则会优先处理最后出现的首部字段。

实体标记（ETag）

End-to-end 首部和 Hop-by-hop 首部

缓存服务器   Cache-Control: private

使用 no-cache 指令的目的是为了防止从缓存中返回过期的资源
Date 表明创建 HTTP 报文的日期和时间。

HTTP/1.1 的传输编码方式仅对分块传输编码有效

使用首部字段 Via 是为了追踪客户端与服务器之间的请求和响应报文 的传输路径。

>通信数据转发程序 ：代理、网关、隧 道

请求首部字段
Accept 首部字段可通知服务器，用户代理能够处理的媒体类型及媒体 类型的相对优先级。

对于只需获取部分资源的范围请求，包含首部字段 Range 即可告知服 务器资源的指定范围。


首部字段 Referer 会告知服务器请求的原始资源的 URI

User-Agent 用于传达浏览器的种类

响应首部字段
首部字段 Accept-Ranges 是用来告知客户端服务器是否能处理范围请 求，以指定获取服务器端某个部分的资源
首部字段 Age 能告知客户端，源服务器在多久前创建了响应。字段值 的单位为秒。

首部字段 Server 告知客户端当前服务器上安装的 HTTP 服务器应用程 序的信息。不单单会标出服务器上的软件应用名称，还有可能包括版 本号和安装时启用的可选项


405 Method Not Allowed

对实体主体进行内容编码传输时，不能再使用 Content-Length 首部字段

Cookie 的工作机制是用户识别及状态管理

响应首部字段    Set-Cookie
请求首部字段    Cookie

仅在 HTTPS 安全通信时才会发送 Cookie
HttpOnly 加以限制，使 Cookie 不能被 JavaScript 脚本访问

HTTP 协议中有可能存在信息窃听或身份伪装等安全问题。使用 HTTPS 通信机制可以有效地防止这些问题。

>HTTP 主要有这些不足，例举如下。 通信使用明文（不加密），内容可能会被窃听 不验证通信方的身份，因此有可能遭遇伪装 无法证明报文的完整性，所以有可能已遭篡改

通信线路加密  通信内容加密

确认通信方（服务器或客户端）持有的证书， 即可判断通信方的真实意图

MD5 和 SHA-1 等散列值校验的方法， 以及用来确认文件的数字签名方法

HTTP+ 加密 + 认证 + 完整性保护 =HTTPS

SSL是独立于 HTTP 的协议，所以不光是 HTTP 协议，其他运行在应 用层的 SMTP 和 Telnet 等协议均可配合 SSL协议使用。可以说 SSL是 当今世界上应用最为广泛的网络安全技术。

https通信过程 第7章
web攻击技术
简单的 HTTP 协议本身并不存在安全性问题，因此协议本身几乎不会 成为攻击的对象。应用 HTTP 协议的服务器和客户端，以及运行在服 务器上的 Web 应用等资源才是攻击目标

请求内容主要用于POST请求，与POST请求方法配套的请求头一般有Content-Type（标识请求内容的类型）和Content-Length（标识请求内容的长度）


在 HTTP/2 中引入了多路复用的技术。多路复用很好的解决了浏览器限制同一个域名下的请求数量的问题，同时也接更容易实现全速传输，毕竟新开一个 TCP 连接都需要慢慢提升传输速度

HTTP/2协议定义了两个字符串标识符：“h2"表示加密的HTTP/2，“h2c”表示明文的HTTP/2。

HTTP/2传输数据量的大幅减少,主要有两个原因:以二进制方式传输和Header 压缩

tcp_keepalive_time默认是2个小时，也就是TCP空闲连接可以存活2个小时，在close_wait状态下，可以把这个时间调小，减少处于close_wait连接的数量

在高并发短连接的业务场景下，由于短连接的传输数据+业务处理的时间很短，所以服务器处理完请求就会立即主动关闭连接，并且进入TIME_WAITING状态，而端口处于有个0~65535的范围中，除去系统占用的，总的数量有限。所以持续的到达一定量的高并发短连接，会使服务器因端口资源不足而拒绝为一部分请求服务。 可以通过修改TCP的默认配置来改善这个问题。


慢启动  拥塞避免时  慢启动阈值变为拥塞窗口一半 拥塞窗口变为1 慢启动

快恢复  拥塞避免时  慢启动阈值变为拥塞窗口一半 拥塞窗口变为慢启动阈值  后期+1 拥塞避免 线性增长