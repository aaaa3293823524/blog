---
title: 数据库学习总结（一）
tags:
  - 数据库

date: 2019-06-20 21:02:36
abbrlink: 79vn2
---
#sql语句练习
牛客网练习

#MySQL技术内幕  InnoDB存储引擎
存储引擎：MyISAM,InnoDB,NDB,Memory,Archive,Federated,Maria,Merge,CSV,Sphinx,Infobright
单进程多线程架构
数据库：文件
数据库实例：进程、线程

范围查询

全盘扫描
##索引与算法   索引内部机制
索引太多 应用性能影响
索引太少  查询性能影响
###B+树索引（B代表平衡）  
查找的是数据行所在的页，然后通过把页调入内存，再查找，最终找到数据

由 二叉查找树，平衡二叉树（AVL树），B树演化而来

AVL树维护价值大  （一次或多次左旋 右旋  看！！！！）

 插入  删除
 聚集索引  辅助聚集索引

 辅助索引的叶节点包含主键，但不包含完整的行信息

 选用时机：如果某个字段取值范围很广，几乎没有重复，高选择性

 顺序读，随机读与预读取

 联合索引  指的是对表上多个列做索引，键值数量大于等于2
###哈希索引
哈希算法  散列表数据结构

自适应哈希索引

>表
存储引擎基于表，不是数据库

存储引擎接口

##逻辑存储结构
表空间
段  区（64个连续页  1MB） 页（64KB）
##物理存储结构

约束   数据完整性
约束和索引的区别   索引是一个数据结构  约束更是一个逻辑的概念 

视图
物化视图
分区表
##关键特性
###插入缓冲 二次写 自适应哈希索引  预读

###存储容量的限制，事务支持，锁的粒度，多版本支持，支持的索引，备份和复制等

>连接MySQL操作是连接进程和MySQL数据库实例进行通信
- TCP/ip  权限视图user表
- 命名管道（named-pipe）和共享内存(shared-memory)
- unix域套接字

>InnoB系统架构

后台线程

InnoDB存储引擎有7个后台线程：4个IO 1个master 1个锁监控线程  1个错误监控线程

master thread 优先级别最高 由几个循环组成，主循环，后台循环，刷新循环，暂停循环
>内存

缓冲池

内存池


>锁
- 行锁  表锁  页锁
- 自增长  
- 锁的算法
- 锁问题：丢失更新   脏读（不同事务下，可以读到另外事务未提交的数据  违反隔离性）  不可重复读（违反一致性）

锁升级 将当前锁的粒度降低   行->页->表

多用户 并发访问用到

>事务   -----区别于文件系统重要特性之一
- ACID特性
A:原子性   整个事务是不可分割单位  只有所有事务的操作全执行成功，事务才算执行成功

C:一致性   一种状态到另一种状态  完整性约束没有被破坏

I:隔离性  在一个事务提交前 对其他事务不可见（通过锁来实现）

D:持久性（事务提交后 改变是永久性的）

A I D通过数据库的redo和undo来完成

- 事务控制语句

- 隐式提交的sql语句+

- 事务隔离级别 四个

- 分布式事务

- 不好的事务习惯
>备份与恢复
热备 冷备 温备
>性能调优

脏读（未提交数据） 

锁升级 （粒度降低）行->页->表

XA事务

SERIALIABLE

二进制日志备份  快照备份  复制